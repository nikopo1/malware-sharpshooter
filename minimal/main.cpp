#include <stdlib.h>
#include <stdio.h>
#include <fstream>
#include <iostream>
#include <string>

#include "graphbuilder.h"	/* graph representation */
#include "malspec.h"		/* malspec algorithm implementation */
#include "util.h"

int main(int argc, char* argv[])
{
	GraphBuilder gb(argv[1], true);
	std::string malware_program(argv[2]);

	int num_files = 0;
	std::ifstream bf(argv[3]);
	std::string tmp_string;
	std::vector<std::string> benign_programs;

	std::vector<Graph*> malspecs;

	bf>>num_files;
	for(int i = 0; i < num_files; i++) {
		std::getline(bf, tmp_string);
		benign_programs.push_back(tmp_string);
	}

	malspecs = malspec_mining(gb, malware_program, benign_programs);

	for(unsigned int i = 0; i < malspecs.size(); i++)
		delete malspecs[i];
	return 0;
}
