#include "../network/interceptor.h"
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/ioctl.h>
#include <fcntl.h>

#include <sys/socket.h>
#include <linux/in.h>

#include <stdio.h>

int main(void) {

	int fd, ret;
	intercept_info_t info;

	fd = open("/proc/interceptor", O_RDONLY);
	if(fd < 0) {
		perror("open failed");
		return  -1;
	}

	info.xport_protocol = IPPROTO_ICMP;
	info.source = 0;
	info.dest = 0;
	
	ret = ioctl(fd, START_INTERCEPT, &info);
	if(ret != 0) {
		perror("ioctl intercept start failure");
		return ret;
	}
	/*
	ret = ioctl(fd, STOP_INTERCEPT, &info);
	if(ret != 0) {
		perror("ioctl intercept stop failure");
		return ret;
	}
	*/

	return 0;
}
